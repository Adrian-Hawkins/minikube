<source>
  @type tail
  path /app/logs/*.log
  pos_file /app/logs/fluentd.pos
  tag app.logs
  read_from_head true
  <parse>
    @type regexp
    expression /^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}) - (?<name>[^ ]*) - (?<level>[^ ]*) - (?<message>.*)$/
    time_format %Y-%m-%d %H:%M:%S,%L
  </parse>
</source>

<match app.logs>
  @type loki
  url "http://loki:3100"
  extra_labels {"job":"fluentd"}
  flush_interval 10s
  flush_at_shutdown true
  buffer_chunk_limit 1m
</match>